---
title: "ENVS-193DS_homework-03"
author: "Ethan Mathews"
date: "05/24/2025"
format: html
---

link to GitHub Repository: https://github.com/ethan-mathews24/ENVS-193DS_homework-03.git


```{r Reading in Packages}
#| message: false

library(tidyverse)

library(gt)

library(janitor)

library(here)

library(readxl)

data <- read.csv(here("data","PersonalStudyHome.csv"))

```


## Part 2. Problems 

### Problem 1. Personal Data 


#### a. 

The data can be summarized by comparing the distribution of water consumption (liters) between cardiovascular and strength training workouts using a box plot that visually represents the distribution and spread of the data, showing the minimum, first quartile, median, third quartile, and maximum, with the underlying data displayed as jitter points. This comparison is informative for me because I typically associate cardiovascular workouts with being more physically demanding and sweat-intensive, potentially leading to greater water intake than strength training sessions, so I expect that water consumption will be higher on days I run or bike compared to when I lift weights.  


#### b.
```{r Personal Data Visualization}

ggplot(data = data, # calling in data frame
       aes(x = Workout_Type, # assigning the categorical predictor variable to the x-axis
           y = Water_Consumption, # assigning the response variable to the y-axis
           fill = Workout_Type)) +  # fill color for boxes
  
 # first layer: boxplot 
   geom_boxplot(color = "black") + # outline color (black)

# second layer: jitter points of raw data   
  geom_jitter(height = 0, # making sure the jitter points don't move along y-axis
              width = 0.15, # narrowing the width of the jitter points
              alpha = 0.6, # making slightly transparent in case of overlap 
              shape = 21, # changing the shape of the points
              aes(fill = Workout_Type, # fill color for the points
                  color = Workout_Type)) +  # outline color for the points
  
  theme(plot.title = element_text(size = 12), # adjusting title size
        plot.subtitle = element_text(size = 8), # adjusting subtitle size
        legend.position = "none", # removing the legend
        panel.background = element_rect(fill = "white"), # changing the background color
        panel.grid.major = element_line(color = NA), # removing the color from the grid lines 
        panel.grid.minor = element_line(color = NA), # removing the color from the grid lines 
        axis.line = element_line(color = "black")) +  # adding back the y and x axis lines   
  
  scale_fill_manual(values = c("cardiovascular" = "darkorchid1", 
                               "strength" = "deepskyblue")) + # changing the fill of the boxplots 
  
  scale_color_manual(values = c("cardiovascular" = "yellow",
                                "strength" = "red")) +  # changing the outline color of the jitter points
  
  labs(title = "How Water Intake Compares to the Type of Workout",  # setting title
       subtitle = "By Ethan Mathews", # adding a subtitle
       x = "Workout Type",  # cleaning the x-axis label
       y = "Water Consumed (liters)")   # cleaning the y-axis label


```


#### c. 
**Figure 1. Cardiovascular workouts are associated with higher water intake.** Data from *Personal study conducted for Data Science in Environmental Studies* (Mathews, E. 2025). Water consumption (liters) was recorded for two types of workouts, cardiovascular (n = 11) and strength training (n = 22). Cardiovascular workouts had a higher median and a more narrow spread of water intake compared to strength training. Transparent open circles represent individual observations and the box plots represent the distribution of values for each group. Colors represent the workout type (purple = cardiovascular and blue = strength training).  


#### d.
```{r Clean/Organizing Data for Table}

data_clean <- data |> # starting data frame 
  clean_names() |> # clean names to standardize format 
  select(water_consumption, workout_type) |> # selecting specific columns 
  mutate(workout_type = recode(workout_type, cardiovascular = "Cardiovascular",
                               strength = "Strength")) # cleaning table names for future table reference 

```

```{r Visual Table}

data_summary <- data_clean |> # starting data frame 
  group_by(workout_type) |> # grouping by the workout type 
  summarize(
    n = n(), # including the number of observations 
    median = median(water_consumption, na.rm = TRUE), # median calculation 
    lower = quantile(water_consumption, 0.25, na.rm = TRUE), # lower quantile calculation 
    upper = quantile(water_consumption, 0.75, na.rm = TRUE), # upper quantile calculation 
    minimum = min(water_consumption, na.rm = TRUE), # minimum value calculation 
    maximum = max(water_consumption, na.rm = TRUE)) |> # maximum value calculation 
  mutate(
    across(c(median, lower, upper, minimum, maximum), 
           ~ round(.x, 1)))  # rounding the previous calculations to 1 decimal point


data_summary |> # starting data frame that has summary statistics
  gt() |> # package for summary table 
  
  tab_header(title = html("<strong>Table 1.</strong> Summary Statistics of Water Intake (liters) by Workout Type")) |> # creating and bolding table header/title
  
  cols_label(
    workout_type = "Workout Type",
    n = "Number of Observations",
    median = "Median",
    lower = "Lower Quantile",
    upper = "Upper Quantile",
    minimum = "Minimum",
    maximum = "Maximum" # cleaning the column names for the table 
  ) |> 
  cols_align(
    align = "left",
    columns = workout_type) |> # changing the alignment 
  cols_align(
    align = "center",
    columns = c(n, median, lower, upper, minimum, maximum)) |> # changing to center alignment 
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())) |> # making the column names bold 
  tab_options(
  table.font.size = "small", # changing font size so it can fit better 
  heading.align = "left") # align the title to the left
  

```


### Problem 2. Affective visualization

#### a. 
When I first thought about affective data visualization, I was drawn to the idea of humanizing dataâ€”transforming numbers on a spreadsheet into something more tangible and relatable. For my project, I plan to represent average water intake by illustrating body parts like back, arms, chest, legs, abs, shoulders, and lungs for endurance along the x-axis. Instead of traditional bars or box plots, each muscle group will be visually represented and "filled" with water to reflect the average amount consumed during workouts targeting that area. To complement this, a small flame icon above each body part will indicate average workout intensity, with four levels/rings that represent the level of intensity for that body part (more rings filled = higher average intensity). This approach personalizes the data, highlighting the physical connection between hydration and strain while making the visualization emotionally engaging and easy to interpret.


#### b. 

![Water intake (liters) by workout type](Affective_Data.jpg)


#### c. 













